---
import { SITE } from '../config';
import Base from '../layout/Base.astro';
import Header from '../components/Header.astro';
import ArchGrid from '../layout/grid/ArchGrid.astro';
import Footer from '../components/Footer.astro';

import '../styles/page/contact.scss';
---

<Base title={`お問い合わせ | ${SITE.title}`}>
  <Header />
  <main class="ly_main">
    <ArchGrid>
      <div class="bl_pageTitle bl_pageTitle_icon bl_pageTitle_icon__mail">
        <svg class="el_title_border el_title_border__pageTitle">
          <text x="50%" y="50%" text-anchor="middle" dominant-baseline="central"
            >お問い合わせ</text
          >
        </svg>
      </div><!-- /.bl_pageTitle -->

      <section class="ly_section__lg">
        <div class="bl_form_lead">
          <p>
            <span class="hp_display_ib__sm"
              >もし少しでもご興味を持っていただけましたら、</span
            ><span class="hp_display_ib__sm">ぜひお気軽にご連絡ください。</span>
          </p>
          <div class="bl_form_successMessage">
            <p class="bl_form_successMessage_title">
              お問い合わせいただき、<br />ありがとうございます。
            </p>
            <p class="bl_form_successMessage_text">
              24時間以内に返信いたします。<br />
              もしも24時間を過ぎても返信がない場合、上手くメールが届いていない可能性がございます。<br
              />
              お手数ですが<a
                href="https://twitter.com/bnku212"
                target="_blank"
                rel="nofollow noopener noreferrer">TwitterのDM</a
              >より、再度ご連絡いただけますと幸いです。
            </p>
          </div><!-- /.bl_form_sccessMessage -->
        </div>
      </section>

      <form id="js_form" class="ly_form" action="" method="POST">
        <dl class="bl_form">
          <!-- お名前 -->
          <div class="bl_form_item">
            <dt class="bl_form_labelWrap">
              <label id="name" for="name" class="bl_form_label">お名前</label>
            </dt><!-- /.bl_form_labelWrap -->
            <dd class="bl_form_inputField bl_form_input__require">
              <input
                type="text"
                name="name"
                id="name"
                class="bl_form_input"
                aria-labelledby="name"
                autocomplete="name"
                required
              />
              <p class="bl_form_exText">
                山田<span class="hp_space_1char"></span>太郎
              </p><!-- /.bl_form_exText -->
              <p class="bl_form_errorText js_form_errorMessage">
                <span></span>お名前を入力してください。
              </p>
            </dd><!-- /.bl_form_inputField -->
          </div><!-- /.bl_form_item -->

          <!-- 企業名 -->
          <div class="bl_form_item">
            <dt class="bl_form_labelWrap">
              <label id="company" for="company" class="bl_form_label">
                企業名
              </label>
            </dt><!-- /.bl_form_labelWrap -->
            <dd class="bl_form_inputField">
              <input
                type="text"
                name="company"
                id="company"
                class="bl_form_input"
                aria-labelledby="company"
                autocomplete="organization"
              />
              <p class="bl_form_exText">
                hoge株式会社
              </p><!-- /.bl_form_exText -->
            </dd><!-- /.bl_form_inputField -->
          </div><!-- /.bl_form_item -->

          <!-- ご連絡先 -->
          <div class="bl_form_item">
            <dt class="bl_form_labelWrap">
              <label id="email" for="mail" class="bl_form_label">ご連絡先</label
              >
            </dt><!-- /.bl_form_labelWrap -->
            <dd class="bl_form_inputField bl_form_input__require">
              <input
                type="email"
                name="email"
                id="mail"
                class="bl_form_input js_form_emailInput"
                aria-labelledby="email"
                required
                autocomplete="email"
              />
              <p class="bl_form_exText">
                sample@sample.com
              </p><!-- /.bl_form_exText -->
              <p class="bl_form_errorText js_form_errorMessage">
                <span></span>メールアドレスを入力してください。
              </p>
              <p
                class="bl_form_errorText__emailExp js_form_errorMessage_emailExp"
              >
                <span></span>正しいメールアドレスの形式ではありません。
              </p>
            </dd><!-- /.bl_form_inputField -->
          </div><!-- /.bl_form_item -->

          <!-- お問い合わせ内容 -->
          <div class="bl_form_item">
            <dt class="bl_form_labelWrap">
              <label id="text" for="contents" class="bl_form_label">
                お問い合わせ内容
              </label>
            </dt><!-- /.bl_form_labelWrap -->
            <dd class="bl_form_inputField bl_form_input__require">
              <textarea
                name="text"
                id="contents"
                class="bl_form_input bl_form_input__textarea"
                aria-labelledby="text"
                required
                autocomplete="off"></textarea>
              <p class="bl_form_errorText js_form_errorMessage">
                <span></span>お問合せ内容を入力してください。
              </p>
            </dd><!-- /.bl_form_inputField -->
          </div><!-- /.bl_form_item -->
        </dl>

        <!-- プライバシーポリシー -->
        <div class="bl_form_privacy">
          <div class="bl_form_privacy_textWrap">
            <p class="bl_form_privacy_title">プライバシーポリシー</p>
            <p class="bl_form_privacy_lead">
              Yurika's
              Portfolio（以下、「当サイト」）は、ユーザーの個人情報の取扱いについて以下のとおりプライバシーポリシー（以下、「本ポリシー」）を定めます。
            </p>
            <p class="bl_form_privacy_subTitle">個人情報の利用目的</p>
            <p class="bl_form_privacy_text">
              当サイトでは、名前やメールアドレス等の個人情報を取得させていただく場合がございます。取得した個人情報は、お問い合わせに対する回答や必要な情報を電子メールなどでご連絡する場合に利用させていただくものであり、これらの目的以外では利用いたしません。
            </p>
            <p class="bl_form_privacy_subTitle">個人情報の安全管理</p>
            <p class="bl_form_privacy_text">
              当サイトではお客様よりお預かりした個人情報を適切に管理し、次のいずれかに該当する場合を除き、個人情報を第三者に開示いたしません。
            </p>
            <p class="bl_form_privacy_subTitle">
              個人情報の第三者への開示・提供
            </p>
            <p class="bl_form_privacy_text">
              当サイトは次に掲げる場合を除いて、同意を得ることなく第三者に個人情報を提供することはありません。<br
              />ただし、個人情報保護法その他の法令で認められる場合を除きます。
            </p>
            <ul>
              <li>
                法律上照会権限を有する者から書面による正式な協力要請、照会があった場合
              </li>
              <li>お客様の同意があった場合</li>
            </ul><!-- /.bl_form_privacy_ist -->
            <p class="bl_form_privacy_subTitle">プライバシーポリシーの変更</p>
            <p class="bl_form_privacy_text">
              本ポリシーの内容は、法令変更などを受けて、ユーザーに通知することなく随時変更することができるものとします。変更後のプライバシーポリシーは、本サイトに掲載したときから効力を生じるものとします。
            </p>
            <p class="bl_form_privacy_subTitle">個人情報に関するお問い合わせ</p>
            <p class="bl_form_privacy_text">
              本ポリシー関するお問い合わせは、下記までお願い致します。<br />
              ゆりか<span></span>メールアドレス:info@yurika122.com
            </p>
          </div><!-- /.bl_form_privacy_textWrap -->

          <div class="bl_form_privacy_checkBox">
            <label>
              <input
                type="checkbox"
                name="privacy"
                value="プライバシーポリシーに同意する"
              /><span>プライバシーポリシーの内容を確認し同意します</span>
            </label>
          </div><!-- /.bl_form_privacy_checkBox -->
        </div><!-- /.bl_form_privacy -->

        <div class="bl_form_btn">
          <button
            class="el_btn el_basicBtn"
            id="js_form_submitBtn"
            type="submit"
            disabled
          >
            送信する
            <img
              src="/img/empty.gif"
              data-src="/icon/arrow-lg.svg"
              alt=""
              width="56"
              height="8"
              loading="lazy"
            />
          </button>
        </div>
      </form>
      <!-- /.ly_main_inner -->
    </ArchGrid>
  </main><!-- /.ly_main -->

  <Footer />
</Base>

<script>
  import 'typed-query-selector';

  /** バリデーションチェック */
  const form = document.getElementById('js_form');
  const requiredInputs = form?.querySelectorAll('input[required]');
  const requiredTextareas = form?.querySelectorAll('textarea[required]');
  const checkItems = [...requiredInputs!, ...requiredTextareas!];
  const messages = form?.querySelectorAll('p.js_form_errorMessage');
  const errorMessages = [...messages!];
  const emailExpErrorMessage = form!.querySelector(
    'p.js_form_errorMessage_emailExp'
  );

  const emailExp =
    /^[a-zA-Z0-9_.+-]+@([a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9]*\.)+[a-zA-Z]{2,}$/;

  checkItems.forEach((item, index) => {
    const errorMessage = errorMessages[index];

    item.addEventListener('blur', () => {
      const itemValue = item.value;

      if (!itemValue) {
        errorMessage?.classList.add('is_display');
      } else {
        errorMessage?.classList.remove('is_display');
      }

      if (item.type === 'email') {
        const itemValue = item.value;
        !emailExp.test(itemValue)
          ? emailExpErrorMessage?.classList.add('is_display')
          : emailExpErrorMessage?.classList.remove('is_display');
      }

      formCheck();
    });
  });

  const submitBtn = document.getElementById('js_form_submitBtn');
  const agreementCheckBox = form?.querySelector('input[type="checkbox"]');

  const formCheck = () => {
    let flag = false;

    for (const item of checkItems) {
      item.value ? (flag = true) : (flag = false);
    }
    agreementCheckBox?.checked && flag
      ? submitBtn?.removeAttribute('disabled')
      : submitBtn?.setAttribute('disabled', '');
  };
  agreementCheckBox?.addEventListener('click', formCheck);
</script>
